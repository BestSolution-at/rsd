// Generated by RSD - Do not modify
package dev.rsdlang.sample.client.jdkhttp.impl.model;

import java.util.function.Function;
import java.util.List;
import java.util.Optional;

import jakarta.json.Json;
import jakarta.json.JsonObject;
import jakarta.json.JsonObjectBuilder;
import jakarta.json.JsonString;

import dev.rsdlang.sample.client.model._Base;
import dev.rsdlang.sample.client.model.PatchableRecordWithUnion;
import dev.rsdlang.sample.client.model.PatchableUnion;
import dev.rsdlang.sample.client.model.PatchableUnionA;
import dev.rsdlang.sample.client.model.PatchableUnionB;

public class PatchableRecordWithUnionPatchImpl extends _BaseDataImpl implements PatchableRecordWithUnion.Patch {
	static class ListSetChangeImpl extends _ChangeSupport.ObjectElementsChange<PatchableUnion.Data> implements ListSetChange {
		ListSetChangeImpl(JsonObject data) {
			super(data, PatchableUnionDataImpl::of);
		}
	}

	static class ListMergeChangeImpl extends _ChangeSupport.ListMergeAddRemoveUpdateImpl<PatchableUnion.Data, PatchableUnion.Patch, String> implements ListMergeChange {
		ListMergeChangeImpl(JsonObject data) {
			super(data, PatchableUnionDataImpl::of, PatchableUnionPatchImpl::of, v -> ((JsonString)v).getString() );
		}
	}

	static class List_NullSetChangeImpl extends _ChangeSupport.ObjectElementsChange<PatchableUnion.Data> implements List_NullSetChange {
		List_NullSetChangeImpl(JsonObject data) {
			super(data, PatchableUnionDataImpl::of);
		}
	}

	static class List_NullMergeChangeImpl extends _ChangeSupport.ListMergeAddRemoveUpdateImpl<PatchableUnion.Data, PatchableUnion.Patch, String> implements List_NullMergeChange {
		List_NullMergeChangeImpl(JsonObject data) {
			super(data, PatchableUnionDataImpl::of, PatchableUnionPatchImpl::of, v -> ((JsonString)v).getString() );
		}
	}

	static class List_OptSetChangeImpl extends _ChangeSupport.ObjectElementsChange<PatchableUnion.Data> implements List_OptSetChange {
		List_OptSetChangeImpl(JsonObject data) {
			super(data, PatchableUnionDataImpl::of);
		}
	}

	static class List_OptMergeChangeImpl extends _ChangeSupport.ListMergeAddRemoveUpdateImpl<PatchableUnion.Data, PatchableUnion.Patch, String> implements List_OptMergeChange {
		List_OptMergeChangeImpl(JsonObject data) {
			super(data, PatchableUnionDataImpl::of, PatchableUnionPatchImpl::of, v -> ((JsonString)v).getString() );
		}
	}

	static class List_Opt_NullSetChangeImpl extends _ChangeSupport.ObjectElementsChange<PatchableUnion.Data> implements List_Opt_NullSetChange {
		List_Opt_NullSetChangeImpl(JsonObject data) {
			super(data, PatchableUnionDataImpl::of);
		}
	}

	static class List_Opt_NullMergeChangeImpl extends _ChangeSupport.ListMergeAddRemoveUpdateImpl<PatchableUnion.Data, PatchableUnion.Patch, String> implements List_Opt_NullMergeChange {
		List_Opt_NullMergeChangeImpl(JsonObject data) {
			super(data, PatchableUnionDataImpl::of, PatchableUnionPatchImpl::of, v -> ((JsonString)v).getString() );
		}
	}

	PatchableRecordWithUnionPatchImpl(JsonObject data) {
		super(data);
	}

	@Override
	public String key() {
		return _JsonUtils.mapString(data, "key");
	}

	@Override
	public String version() {
		return _JsonUtils.mapString(data, "version");
	}

	public Optional<PatchableUnion> value() {
		return _JsonUtils.mapOptObject(data, "value", o -> _ChangeSupport.of(o, "@type", PatchableUnionDataImpl::of, PatchableUnionPatchImpl::of));
	}

	public _Base.Nillable<PatchableUnion> value_Null() {
		return _JsonUtils.mapNilObject(data, "value_Null", o -> _ChangeSupport.of(o, "@type", PatchableUnionDataImpl::of, PatchableUnionPatchImpl::of));
	}

	public _Base.Nillable<PatchableUnion> value_Opt() {
		return _JsonUtils.mapNilObject(data, "value_Opt", o -> _ChangeSupport.of(o, "@type", PatchableUnionDataImpl::of, PatchableUnionPatchImpl::of));
	}

	public _Base.Nillable<PatchableUnion> value_Opt_Null() {
		return _JsonUtils.mapNilObject(data, "value_Opt_Null", o -> _ChangeSupport.of(o, "@type", PatchableUnionDataImpl::of, PatchableUnionPatchImpl::of));
	}

	public Optional<ListChange> list() {
		return _JsonUtils.mapOptObject(data, "list", o -> _ChangeSupport.of(o, "@type", ListSetChangeImpl::new, ListMergeChangeImpl::new));
	}

	public _Base.Nillable<List_NullChange> list_Null() {
		return _JsonUtils.mapNilObject(data, "list_Null", o -> _ChangeSupport.of(o, "@type", List_NullSetChangeImpl::new, List_NullMergeChangeImpl::new));
	}

	public _Base.Nillable<List_OptChange> list_Opt() {
		return _JsonUtils.mapNilObject(data, "list_Opt", o -> _ChangeSupport.of(o, "@type", List_OptSetChangeImpl::new, List_OptMergeChangeImpl::new));
	}

	public _Base.Nillable<List_Opt_NullChange> list_Opt_Null() {
		return _JsonUtils.mapNilObject(data, "list_Opt_Null", o -> _ChangeSupport.of(o, "@type", List_Opt_NullSetChangeImpl::new, List_Opt_NullMergeChangeImpl::new));
	}

	public static class PatchBuilderImpl implements PatchableRecordWithUnion.PatchBuilder {
		private JsonObjectBuilder $builder = Json.createObjectBuilder();

		public PatchableRecordWithUnion.PatchBuilder key(String key) {
			$builder.add("key", key);
			return this;
		}

		public PatchableRecordWithUnion.PatchBuilder version(String version) {
			$builder.add("version", version);
			return this;
		}

		@Override
		public PatchableRecordWithUnion.PatchBuilder value(PatchableUnion value) {
			var $changeBuilder = Json.createObjectBuilder(((_BaseDataImpl) value).data);
			if (value instanceof PatchableUnion.Data) {
				$changeBuilder.add("@type", "replace");
			} else {
				$changeBuilder.add("@type", "merge");
			}
			$builder.add("value", $changeBuilder.build());
			return this;
		}

		public <T extends PatchableUnion.Builder> PatchableRecordWithUnion.PatchBuilder withValue(Class<T> clazz, Function<T, PatchableUnion> block) {
			PatchableUnion.Builder b;
			if (clazz == PatchableUnionA.DataBuilder.class) {
				b = PatchableUnionADataImpl.builder();
			} else if (clazz == PatchableUnionB.DataBuilder.class) {
				b = PatchableUnionBDataImpl.builder();
			} else if (clazz == PatchableUnionA.PatchBuilder.class) {
				b = PatchableUnionAPatchImpl.builder();
			} else if (clazz == PatchableUnionB.PatchBuilder.class) {
				b = PatchableUnionBPatchImpl.builder();
			} else {
				throw new IllegalArgumentException("Unsupported builder type %s".formatted(clazz));
			}

			return value(block.apply(clazz.cast(b)));
		}

		@Override
		public PatchableRecordWithUnion.PatchBuilder value_Null(PatchableUnion value_Null) {
			if (value_Null == null) {
				$builder.addNull("value_Null");
				return this;
			}
			var $changeBuilder = Json.createObjectBuilder(((_BaseDataImpl) value_Null).data);
			if (value_Null instanceof PatchableUnion.Data) {
				$changeBuilder.add("@type", "replace");
			} else {
				$changeBuilder.add("@type", "merge");
			}
			$builder.add("value_Null", $changeBuilder.build());
			return this;
		}

		public <T extends PatchableUnion.Builder> PatchableRecordWithUnion.PatchBuilder withValue_Null(Class<T> clazz, Function<T, PatchableUnion> block) {
			PatchableUnion.Builder b;
			if (clazz == PatchableUnionA.DataBuilder.class) {
				b = PatchableUnionADataImpl.builder();
			} else if (clazz == PatchableUnionB.DataBuilder.class) {
				b = PatchableUnionBDataImpl.builder();
			} else if (clazz == PatchableUnionA.PatchBuilder.class) {
				b = PatchableUnionAPatchImpl.builder();
			} else if (clazz == PatchableUnionB.PatchBuilder.class) {
				b = PatchableUnionBPatchImpl.builder();
			} else {
				throw new IllegalArgumentException("Unsupported builder type %s".formatted(clazz));
			}

			return value_Null(block.apply(clazz.cast(b)));
		}

		@Override
		public PatchableRecordWithUnion.PatchBuilder value_Opt(PatchableUnion value_Opt) {
			if (value_Opt == null) {
				$builder.addNull("value_Opt");
				return this;
			}
			var $changeBuilder = Json.createObjectBuilder(((_BaseDataImpl) value_Opt).data);
			if (value_Opt instanceof PatchableUnion.Data) {
				$changeBuilder.add("@type", "replace");
			} else {
				$changeBuilder.add("@type", "merge");
			}
			$builder.add("value_Opt", $changeBuilder.build());
			return this;
		}

		public <T extends PatchableUnion.Builder> PatchableRecordWithUnion.PatchBuilder withValue_Opt(Class<T> clazz, Function<T, PatchableUnion> block) {
			PatchableUnion.Builder b;
			if (clazz == PatchableUnionA.DataBuilder.class) {
				b = PatchableUnionADataImpl.builder();
			} else if (clazz == PatchableUnionB.DataBuilder.class) {
				b = PatchableUnionBDataImpl.builder();
			} else if (clazz == PatchableUnionA.PatchBuilder.class) {
				b = PatchableUnionAPatchImpl.builder();
			} else if (clazz == PatchableUnionB.PatchBuilder.class) {
				b = PatchableUnionBPatchImpl.builder();
			} else {
				throw new IllegalArgumentException("Unsupported builder type %s".formatted(clazz));
			}

			return value_Opt(block.apply(clazz.cast(b)));
		}

		@Override
		public PatchableRecordWithUnion.PatchBuilder value_Opt_Null(PatchableUnion value_Opt_Null) {
			if (value_Opt_Null == null) {
				$builder.addNull("value_Opt_Null");
				return this;
			}
			var $changeBuilder = Json.createObjectBuilder(((_BaseDataImpl) value_Opt_Null).data);
			if (value_Opt_Null instanceof PatchableUnion.Data) {
				$changeBuilder.add("@type", "replace");
			} else {
				$changeBuilder.add("@type", "merge");
			}
			$builder.add("value_Opt_Null", $changeBuilder.build());
			return this;
		}

		public <T extends PatchableUnion.Builder> PatchableRecordWithUnion.PatchBuilder withValue_Opt_Null(Class<T> clazz, Function<T, PatchableUnion> block) {
			PatchableUnion.Builder b;
			if (clazz == PatchableUnionA.DataBuilder.class) {
				b = PatchableUnionADataImpl.builder();
			} else if (clazz == PatchableUnionB.DataBuilder.class) {
				b = PatchableUnionBDataImpl.builder();
			} else if (clazz == PatchableUnionA.PatchBuilder.class) {
				b = PatchableUnionAPatchImpl.builder();
			} else if (clazz == PatchableUnionB.PatchBuilder.class) {
				b = PatchableUnionBPatchImpl.builder();
			} else {
				throw new IllegalArgumentException("Unsupported builder type %s".formatted(clazz));
			}

			return value_Opt_Null(block.apply(clazz.cast(b)));
		}

		public PatchableRecordWithUnion.PatchBuilder list(ListChange list) {
			$builder.add("list", ((_BaseDataImpl) list).data);
			return this;
		}

		public PatchableRecordWithUnion.PatchBuilder list(List<PatchableUnion.Data> additions, List<PatchableUnion.Patch> updates, List<String> removals) {
			var $changeBuilder = Json.createObjectBuilder();
			$changeBuilder.add("@type", "merge");
			$changeBuilder.add("additions", _JsonUtils.toJsonValueArray(additions, $e -> ((_BaseDataImpl) $e).data));
			$changeBuilder.add("updates", _JsonUtils.toJsonValueArray(updates, $e -> ((_BaseDataImpl) $e).data));
			$changeBuilder.add("removals", _JsonUtils.toJsonStringArray(removals));
			$builder.add("list", $changeBuilder.build());
			return this;
		}

		public PatchableRecordWithUnion.PatchBuilder list(List<PatchableUnion.Data> elements) {
			var $changeBuilder = Json.createObjectBuilder();
			$changeBuilder.add("@type", "replace");
			$changeBuilder.add("elements", _JsonUtils.toJsonValueArray(elements, $e -> ((_BaseDataImpl) $e).data));
			$builder.add("list", $changeBuilder.build());
			return this;
		}

		public PatchableRecordWithUnion.PatchBuilder list_Null(List_NullChange list_Null) {
			$builder.add("list_Null", ((_BaseDataImpl) list_Null).data);
			return this;
		}

		public PatchableRecordWithUnion.PatchBuilder list_Null(List<PatchableUnion.Data> additions, List<PatchableUnion.Patch> updates, List<String> removals) {
			var $changeBuilder = Json.createObjectBuilder();
			$changeBuilder.add("@type", "merge");
			$changeBuilder.add("additions", _JsonUtils.toJsonValueArray(additions, $e -> ((_BaseDataImpl) $e).data));
			$changeBuilder.add("updates", _JsonUtils.toJsonValueArray(updates, $e -> ((_BaseDataImpl) $e).data));
			$changeBuilder.add("removals", _JsonUtils.toJsonStringArray(removals));
			$builder.add("list_Null", $changeBuilder.build());
			return this;
		}

		public PatchableRecordWithUnion.PatchBuilder list_Null(List<PatchableUnion.Data> elements) {
			var $changeBuilder = Json.createObjectBuilder();
			$changeBuilder.add("@type", "replace");
			$changeBuilder.add("elements", _JsonUtils.toJsonValueArray(elements, $e -> ((_BaseDataImpl) $e).data));
			$builder.add("list_Null", $changeBuilder.build());
			return this;
		}

		public PatchableRecordWithUnion.PatchBuilder list_Opt(List_OptChange list_Opt) {
			$builder.add("list_Opt", ((_BaseDataImpl) list_Opt).data);
			return this;
		}

		public PatchableRecordWithUnion.PatchBuilder list_Opt(List<PatchableUnion.Data> additions, List<PatchableUnion.Patch> updates, List<String> removals) {
			var $changeBuilder = Json.createObjectBuilder();
			$changeBuilder.add("@type", "merge");
			$changeBuilder.add("additions", _JsonUtils.toJsonValueArray(additions, $e -> ((_BaseDataImpl) $e).data));
			$changeBuilder.add("updates", _JsonUtils.toJsonValueArray(updates, $e -> ((_BaseDataImpl) $e).data));
			$changeBuilder.add("removals", _JsonUtils.toJsonStringArray(removals));
			$builder.add("list_Opt", $changeBuilder.build());
			return this;
		}

		public PatchableRecordWithUnion.PatchBuilder list_Opt(List<PatchableUnion.Data> elements) {
			var $changeBuilder = Json.createObjectBuilder();
			$changeBuilder.add("@type", "replace");
			$changeBuilder.add("elements", _JsonUtils.toJsonValueArray(elements, $e -> ((_BaseDataImpl) $e).data));
			$builder.add("list_Opt", $changeBuilder.build());
			return this;
		}

		public PatchableRecordWithUnion.PatchBuilder list_Opt_Null(List_Opt_NullChange list_Opt_Null) {
			$builder.add("list_Opt_Null", ((_BaseDataImpl) list_Opt_Null).data);
			return this;
		}

		public PatchableRecordWithUnion.PatchBuilder list_Opt_Null(List<PatchableUnion.Data> additions, List<PatchableUnion.Patch> updates, List<String> removals) {
			var $changeBuilder = Json.createObjectBuilder();
			$changeBuilder.add("@type", "merge");
			$changeBuilder.add("additions", _JsonUtils.toJsonValueArray(additions, $e -> ((_BaseDataImpl) $e).data));
			$changeBuilder.add("updates", _JsonUtils.toJsonValueArray(updates, $e -> ((_BaseDataImpl) $e).data));
			$changeBuilder.add("removals", _JsonUtils.toJsonStringArray(removals));
			$builder.add("list_Opt_Null", $changeBuilder.build());
			return this;
		}

		public PatchableRecordWithUnion.PatchBuilder list_Opt_Null(List<PatchableUnion.Data> elements) {
			var $changeBuilder = Json.createObjectBuilder();
			$changeBuilder.add("@type", "replace");
			$changeBuilder.add("elements", _JsonUtils.toJsonValueArray(elements, $e -> ((_BaseDataImpl) $e).data));
			$builder.add("list_Opt_Null", $changeBuilder.build());
			return this;
		}

		@Override
		public PatchableRecordWithUnion.Patch build() {
			return new PatchableRecordWithUnionPatchImpl($builder.build());
		}
	}

	public static PatchableRecordWithUnion.Patch of(JsonObject obj) {
		return new PatchableRecordWithUnionPatchImpl(obj);
	}

	public static PatchBuilderImpl builder() {
		return new PatchBuilderImpl();
	}
}
