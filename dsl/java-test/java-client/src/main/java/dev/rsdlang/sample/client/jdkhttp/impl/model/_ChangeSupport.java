// Generated by RSD - Do not modify
package dev.rsdlang.sample.client.jdkhttp.impl.model;

import java.util.function.Function;
import java.util.List;

import jakarta.json.JsonObject;
import jakarta.json.JsonValue;

import dev.rsdlang.sample.client.model._Base;

public class _ChangeSupport {
	public static <T> T of(JsonObject o, String descProperty, Function<JsonObject, T> setFactory, Function<JsonObject, T> deltaFactory) {
		var type = o.getString(descProperty);
		return switch (type) {
			case "replace" -> setFactory.apply(o);
			case "merge" -> deltaFactory.apply(o);
			default -> throw new IllegalStateException("Unknown @type '%s'".formatted(type));
		};
	}

	public abstract static class ListMergeAddRemoveImpl<A, R> extends _BaseDataImpl
			implements _Base.ListMergeAddRemove<A, R> {
		private final Function<JsonValue, A> additionConverter;
		private final Function<JsonValue, R> removalConverter;

		ListMergeAddRemoveImpl(
				JsonObject data,
				Function<JsonValue, A> additionConverter,
				Function<JsonValue, R> removalConverter) {
			super(data);
			this.additionConverter = additionConverter;
			this.removalConverter = removalConverter;
		}

		@Override
		public List<A> additions() {
			return _JsonUtils.mapToStream(
					data,
					"additions",
					JsonValue.class,
					additionConverter).toList();
		}

		@Override
		public List<R> removals() {
			return _JsonUtils.mapToStream(
				data,
				"removals",
				JsonValue.class,
				removalConverter).toList();
		}
	}

	public abstract static class ListMergeAddRemoveUpdateImpl<A, U, R> extends _BaseDataImpl
			implements _Base.ListMergeAddRemoveUpdate<A, U, R> {

		private final Function<JsonObject, A> additionConverter;
		private final Function<JsonObject, U> updateConverter;
		private final Function<JsonValue, R> removalConverter;

		public ListMergeAddRemoveUpdateImpl(
				JsonObject data,
				Function<JsonObject, A> additionConverter,
				Function<JsonObject, U> updateConverter,
				Function<JsonValue, R> removalConverter) {
			super(data);
			this.additionConverter = additionConverter;
			this.updateConverter = updateConverter;
			this.removalConverter = removalConverter;
		}

		@Override
		public List<A> additions() {
			return _JsonUtils.mapObjects(data, "additions", this.additionConverter);
		}

		@Override
		public List<R> removals() {
			return _JsonUtils.mapToStream(data, "removals", JsonValue.class, this.removalConverter).toList();
		}

		@Override
		public List<U> updates() {
			return _JsonUtils.mapObjects(data, "updates", this.updateConverter);
		}
	}

	public abstract static class ValueElementsChange<T> extends _BaseDataImpl implements _Base.ListReplace<T> {
		private final Function<JsonValue, T> converter;

		ValueElementsChange(JsonObject data, Function<JsonValue, T> converter) {
			super(data);
			this.converter = converter;
		}

		@Override
		public List<T> elements() {
			return _JsonUtils.mapToStream(data, "elements", JsonValue.class, converter).toList();
		}
	}

	public abstract static class ObjectElementsChange<T> extends _BaseDataImpl implements _Base.ListReplace<T> {
		private final Function<JsonObject, T> converter;

		ObjectElementsChange(JsonObject data, Function<JsonObject, T> converter) {
			super(data);
			this.converter = converter;
		}

		@Override
		public List<T> elements() {
			return _JsonUtils.mapObjects(data, "elements", converter);
		}
	}
}

